<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ticket Achev√©</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-5">
 <div class="card shadow-lg p-4 text-center rounded-4">
  <h4 class="mb-3">üé´ Votre Ticket ‚Äì Caf√© Motivation GO'UP</h4>

  <div id="ticket-info" class="mb-4"></div>

  <div class="d-grid gap-2">
    <button class="btn btn-success btn-lg" id="whatsappBtn">
      <i class="fab fa-whatsapp me-2"></i>
      Confirmer sur WhatsApp
    </button>

    <button class="btn btn-outline-secondary" onclick="window.print()">
      Imprimer le ticket
    </button>
  </div>
</div>

</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
<script>
$(document).ready(function(){
    const ticket = JSON.parse(localStorage.getItem('lastTicket'));

    if(!ticket) {
        $("#ticket-info").html("<p class='text-danger'>Aucun ticket trouv√© !</p>");
        return;
    }

    $("#ticket-info").html(`
        <p><strong>Nom :</strong> ${ticket.nom}</p>
        <p><strong>T√©l√©phone :</strong> ${ticket.tel}</p>
        <p><strong>Ticket :</strong> ${ticket.type_ticket}</p>
        <p><strong>Montant :</strong> ${ticket.prix} F CFA</p>
        <p><strong>R√©f√©rence :</strong> ${ticket.reference}</p>
        <canvas id="qrcode" class="my-3"></canvas>
    `);

    // QR Code
    new QRious({
        element: document.getElementById('qrcode'),
        value: ticket.reference,
        size: 150
    });

    // WhatsApp confirmation
    $("#whatsappBtn").click(function(){
        const message = `
Bonjour GO'UP üëã

Je confirme mon achat de ticket pour *Caf√© Motivation GO'UP* ‚òïüî•

Nom : ${ticket.nom}
T√©l√©phone : ${ticket.tel}
Ticket : ${ticket.type_ticket}
Montant : ${ticket.prix} FCFA
R√©f√©rence : ${ticket.reference}

Merci üôè
        `;

        const phone = "221784953056";
        const url = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
        window.open(url, "_blank");
    });
});
</script>
</body>
</html>
